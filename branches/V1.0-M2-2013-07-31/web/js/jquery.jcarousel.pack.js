(function(a){a.fn.jcarousel=function(a){return this.each(function(){new c(this,a)})};var b={vertical:false,start:1,offset:1,size:null,scroll:3,visible:null,animation:"normal",easing:"swing",auto:0,wrap:null,initCallback:null,reloadCallback:null,itemLoadCallback:null,itemFirstInCallback:null,itemFirstOutCallback:null,itemLastInCallback:null,itemLastOutCallback:null,itemVisibleInCallback:null,itemVisibleOutCallback:null,buttonNextHTML:"<div></div>",buttonPrevHTML:"<div></div>",buttonNextEvent:"click",buttonPrevEvent:"click",buttonNextCallback:null,buttonPrevCallback:null};a.jcarousel=function(c,d){this.options=a.extend({},b,d||{});this.locked=false;this.container=null;this.clip=null;this.list=null;this.buttonNext=null;this.buttonPrev=null;this.wh=!this.options.vertical?"width":"height";this.lt=!this.options.vertical?"left":"top";var e="",f=c.className.split(" ");for(var g=0;g<f.length;g++){if(f[g].indexOf("jcarousel-skin")!=-1){a(c).removeClass(f[g]);var e=f[g];break}}if(c.nodeName=="UL"||c.nodeName=="OL"){this.list=a(c);this.container=this.list.parent();if(this.container.hasClass("jcarousel-clip")){if(!this.container.parent().hasClass("jcarousel-container"))this.container=this.container.wrap("<div></div>");this.container=this.container.parent()}else if(!this.container.hasClass("jcarousel-container"))this.container=this.list.wrap("<div></div>").parent()}else{this.container=a(c);this.list=a(c).find(">ul,>ol,div>ul,div>ol")}if(e!=""&&this.container.parent()[0].className.indexOf("jcarousel-skin")==-1)this.container.wrap('<div class=" '+e+'"></div>');this.clip=this.list.parent();if(!this.clip.length||!this.clip.hasClass("jcarousel-clip"))this.clip=this.list.wrap("<div></div>").parent();this.buttonPrev=a(".jcarousel-prev",this.container);if(this.buttonPrev.size()==0&&this.options.buttonPrevHTML!=null)this.buttonPrev=this.clip.before(this.options.buttonPrevHTML).prev();this.buttonPrev.addClass(this.className("jcarousel-prev"));this.buttonNext=a(".jcarousel-next",this.container);if(this.buttonNext.size()==0&&this.options.buttonNextHTML!=null)this.buttonNext=this.clip.before(this.options.buttonNextHTML).prev();this.buttonNext.addClass(this.className("jcarousel-next"));this.clip.addClass(this.className("jcarousel-clip"));this.list.addClass(this.className("jcarousel-list"));this.container.addClass(this.className("jcarousel-container"));var h=this.options.visible!=null?Math.ceil(this.clipping()/this.options.visible):null;var i=this.list.children("li");var j=this;if(i.size()>0){var k=0,g=this.options.offset;i.each(function(){j.format(this,g++);k+=j.dimension(this,h)});this.list.css(this.wh,k+"px");if(!d||d.size===undefined)this.options.size=i.size()}this.container.css("display","block");this.buttonNext.css("display","block");this.buttonPrev.css("display","block");this.funcNext=function(){j.next()};this.funcPrev=function(){j.prev()};this.funcResize=function(){j.reload()};if(this.options.initCallback!=null)this.options.initCallback(this,"init");this.setup()};var c=a.jcarousel;c.fn=c.prototype={jcarousel:"0.2.3"};c.fn.extend=c.extend=a.extend;c.fn.extend({setup:function(){this.first=null;this.last=null;this.prevFirst=null;this.prevLast=null;this.animating=false;this.timer=null;this.tail=null;this.inTail=false;if(this.locked)return;this.list.css(this.lt,this.pos(this.options.offset)+"px");var b=this.pos(this.options.start);this.prevFirst=this.prevLast=null;this.animate(b,false);a(window).unbind("resize",this.funcResize).bind("resize",this.funcResize)},reset:function(){this.list.empty();this.list.css(this.lt,"0px");this.list.css(this.wh,"10px");if(this.options.initCallback!=null)this.options.initCallback(this,"reset");this.setup()},reload:function(){if(this.tail!=null&&this.inTail)this.list.css(this.lt,c.intval(this.list.css(this.lt))+this.tail);this.tail=null;this.inTail=false;if(this.options.reloadCallback!=null)this.options.reloadCallback(this);if(this.options.visible!=null){var b=this;var d=Math.ceil(this.clipping()/this.options.visible),e=0,f=0;a("li",this.list).each(function(a){e+=b.dimension(this,d);if(a+1<b.first)f=e});this.list.css(this.wh,e+"px");this.list.css(this.lt,-f+"px")}this.scroll(this.first,false)},lock:function(){this.locked=true;this.buttons()},unlock:function(){this.locked=false;this.buttons()},size:function(a){if(a!=undefined){this.options.size=a;if(!this.locked)this.buttons()}return this.options.size},has:function(a,b){if(b==undefined||!b)b=a;if(this.options.size!==null&&b>this.options.size)b=this.options.size;for(var c=a;c<=b;c++){var d=this.get(c);if(!d.length||d.hasClass("jcarousel-item-placeholder"))return false}return true},get:function(b){return a(".jcarousel-item-"+b,this.list)},add:function(a,b){var d=this.get(a),e=0,f=0;if(d.length==0){var g,d=this.create(a),h=c.intval(a);while(g=this.get(--h)){if(h<=0||g.length){h<=0?this.list.prepend(d):g.after(d);break}}}else e=this.dimension(d);d.removeClass(this.className("jcarousel-item-placeholder"));typeof b=="string"?d.html(b):d.empty().append(b);var i=this.options.visible!=null?Math.ceil(this.clipping()/this.options.visible):null;var j=this.dimension(d,i)-e;if(a>0&&a<this.first)this.list.css(this.lt,c.intval(this.list.css(this.lt))-j+"px");this.list.css(this.wh,c.intval(this.list.css(this.wh))+j+"px");return d},remove:function(a){var b=this.get(a);if(!b.length||a>=this.first&&a<=this.last)return;var d=this.dimension(b);if(a<this.first)this.list.css(this.lt,c.intval(this.list.css(this.lt))+d+"px");b.remove();this.list.css(this.wh,c.intval(this.list.css(this.wh))-d+"px")},next:function(){this.stopAuto();if(this.tail!=null&&!this.inTail)this.scrollTail(false);else this.scroll((this.options.wrap=="both"||this.options.wrap=="last")&&this.options.size!=null&&this.last==this.options.size?1:this.first+this.options.scroll)},prev:function(){this.stopAuto();if(this.tail!=null&&this.inTail)this.scrollTail(true);else this.scroll((this.options.wrap=="both"||this.options.wrap=="first")&&this.options.size!=null&&this.first==1?this.options.size:this.first-this.options.scroll)},scrollTail:function(a){if(this.locked||this.animating||!this.tail)return;var b=c.intval(this.list.css(this.lt));!a?b-=this.tail:b+=this.tail;this.inTail=!a;this.prevFirst=this.first;this.prevLast=this.last;this.animate(b)},scroll:function(a,b){if(this.locked||this.animating)return;this.animate(this.pos(a),b)},pos:function(a){if(this.locked||this.animating)return;if(this.options.wrap!="circular")a=a<1?1:this.options.size&&a>this.options.size?this.options.size:a;var b=this.first>a;var d=c.intval(this.list.css(this.lt));var e=this.options.wrap!="circular"&&this.first<=1?1:this.first;var f=b?this.get(e):this.get(this.last);var g=b?e:e-1;var h=null,i=0,j=false,k=0;while(b?--g>=a:++g<a){h=this.get(g);j=!h.length;if(h.length==0){h=this.create(g).addClass(this.className("jcarousel-item-placeholder"));f[b?"before":"after"](h)}f=h;k=this.dimension(h);if(j)i+=k;if(this.first!=null&&(this.options.wrap=="circular"||g>=1&&(this.options.size==null||g<=this.options.size)))d=b?d+k:d-k}var l=this.clipping();var m=[];var n=0,g=a,o=0;var f=this.get(a-1);while(++n){h=this.get(g);j=!h.length;if(h.length==0){h=this.create(g).addClass(this.className("jcarousel-item-placeholder"));f.length==0?this.list.prepend(h):f[b?"before":"after"](h)}f=h;var k=this.dimension(h);if(k==0){return 0}if(this.options.wrap!="circular"&&this.options.size!==null&&g>this.options.size)m.push(h);else if(j)i+=k;o+=k;if(o>=l)break;g++}for(var p=0;p<m.length;p++)m[p].remove();if(i>0){this.list.css(this.wh,this.dimension(this.list)+i+"px");if(b){d-=i;this.list.css(this.lt,c.intval(this.list.css(this.lt))-i+"px")}}var q=a+n-1;if(this.options.wrap!="circular"&&this.options.size&&q>this.options.size)q=this.options.size;if(g>q){n=0,g=q,o=0;while(++n){var h=this.get(g--);if(!h.length)break;o+=this.dimension(h);if(o>=l)break}}var r=q-n+1;if(this.options.wrap!="circular"&&r<1)r=1;if(this.inTail&&b){d+=this.tail;this.inTail=false}this.tail=null;if(this.options.wrap!="circular"&&q==this.options.size&&q-n+1>=1){var s=c.margin(this.get(q),!this.options.vertical?"marginRight":"marginBottom");if(o-s>l)this.tail=o-l-s}while(a-->r)d+=this.dimension(this.get(a));this.prevFirst=this.first;this.prevLast=this.last;this.first=r;this.last=q;return d},animate:function(a,b){if(this.locked||this.animating)return;this.animating=true;var c=this;var d=function(){c.animating=false;if(a==0)c.list.css(c.lt,0);if(c.options.wrap=="both"||c.options.wrap=="last"||c.options.size==null||c.last<c.options.size)c.startAuto();c.buttons();c.notify("onAfterAnimation")};this.notify("onBeforeAnimation");if(!this.options.animation||b==false){this.list.css(this.lt,a+"px");d()}else{var e=!this.options.vertical?{left:a}:{top:a};this.list.animate(e,this.options.animation,this.options.easing,d)}},startAuto:function(a){if(a!=undefined)this.options.auto=a;if(this.options.auto==0)return this.stopAuto();if(this.timer!=null)return;var b=this;this.timer=setTimeout(function(){b.next()},this.options.auto*1e3)},stopAuto:function(){if(this.timer==null)return;clearTimeout(this.timer);this.timer=null},buttons:function(a,b){if(a==undefined||a==null){var a=!this.locked&&this.options.size!==0&&(this.options.wrap&&this.options.wrap!="first"||this.options.size==null||this.last<this.options.size);if(!this.locked&&(!this.options.wrap||this.options.wrap=="first")&&this.options.size!=null&&this.last>=this.options.size)a=this.tail!=null&&!this.inTail}if(b==undefined||b==null){var b=!this.locked&&this.options.size!==0&&(this.options.wrap&&this.options.wrap!="last"||this.first>1);if(!this.locked&&(!this.options.wrap||this.options.wrap=="last")&&this.options.size!=null&&this.first==1)b=this.tail!=null&&this.inTail}var c=this;this.buttonNext[a?"bind":"unbind"](this.options.buttonNextEvent,this.funcNext)[a?"removeClass":"addClass"](this.className("jcarousel-next-disabled")).attr("disabled",a?false:false);this.buttonPrev[b?"bind":"unbind"](this.options.buttonPrevEvent,this.funcPrev)[b?"removeClass":"addClass"](this.className("jcarousel-prev-disabled")).attr("disabled",b?false:false);if(this.buttonNext.length>0&&(this.buttonNext[0].jcarouselstate==undefined||this.buttonNext[0].jcarouselstate!=a)&&this.options.buttonNextCallback!=null){this.buttonNext.each(function(){c.options.buttonNextCallback(c,this,a)});this.buttonNext[0].jcarouselstate=a}if(this.buttonPrev.length>0&&(this.buttonPrev[0].jcarouselstate==undefined||this.buttonPrev[0].jcarouselstate!=b)&&this.options.buttonPrevCallback!=null){this.buttonPrev.each(function(){c.options.buttonPrevCallback(c,this,b)});this.buttonPrev[0].jcarouselstate=b}},notify:function(a){var b=this.prevFirst==null?"init":this.prevFirst<this.first?"next":"prev";this.callback("itemLoadCallback",a,b);if(this.prevFirst!==this.first){this.callback("itemFirstInCallback",a,b,this.first);this.callback("itemFirstOutCallback",a,b,this.prevFirst)}if(this.prevLast!==this.last){this.callback("itemLastInCallback",a,b,this.last);this.callback("itemLastOutCallback",a,b,this.prevLast)}this.callback("itemVisibleInCallback",a,b,this.first,this.last,this.prevFirst,this.prevLast);this.callback("itemVisibleOutCallback",a,b,this.prevFirst,this.prevLast,this.first,this.last)},callback:function(b,c,d,e,f,g,h){if(this.options[b]==undefined||typeof this.options[b]!="object"&&c!="onAfterAnimation")return;var i=typeof this.options[b]=="object"?this.options[b][c]:this.options[b];if(!a.isFunction(i))return;var j=this;if(e===undefined)i(j,d,c);else if(f===undefined)this.get(e).each(function(){i(j,this,e,d,c)});else{for(var k=e;k<=f;k++)if(k!==null&&!(k>=g&&k<=h))this.get(k).each(function(){i(j,this,k,d,c)})}},create:function(a){return this.format("<li></li>",a)},format:function(b,c){var d=a(b).addClass(this.className("jcarousel-item")).addClass(this.className("jcarousel-item-"+c));d.attr("jcarouselindex",c);return d},className:function(a){return a+" "+a+(!this.options.vertical?"-horizontal":"-vertical")},dimension:function(b,d){var e=b.jquery!=undefined?b[0]:b;var f=!this.options.vertical?e.offsetWidth+c.margin(e,"marginLeft")+c.margin(e,"marginRight"):e.offsetHeight+c.margin(e,"marginTop")+c.margin(e,"marginBottom");if(d==undefined||f==d)return f;var g=!this.options.vertical?d-c.margin(e,"marginLeft")-c.margin(e,"marginRight"):d-c.margin(e,"marginTop")-c.margin(e,"marginBottom");a(e).css(this.wh,g+"px");return this.dimension(e)},clipping:function(){return!this.options.vertical?this.clip[0].offsetWidth-c.intval(this.clip.css("borderLeftWidth"))-c.intval(this.clip.css("borderRightWidth")):this.clip[0].offsetHeight-c.intval(this.clip.css("borderTopWidth"))-c.intval(this.clip.css("borderBottomWidth"))},index:function(a,b){if(b==undefined)b=this.options.size;return Math.round(((a-1)/b-Math.floor((a-1)/b))*b)+1}});c.extend({defaults:function(c){return a.extend(b,c||{})},margin:function(b,d){if(!b)return 0;var e=b.jquery!=undefined?b[0]:b;return c.intval(a.css(e,d))},intval:function(a){a=parseInt(a);return isNaN(a)?0:a}})})(jQuery)